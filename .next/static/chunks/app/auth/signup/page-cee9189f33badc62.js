(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[271],{8516:function(e,r,t){Promise.resolve().then(t.bind(t,667))},667:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return d}});var a=t(7437),s=t(998),n=t(6463),l=t(2265),o=t(1942),i=t(7138);function c(){let e=(0,n.useRouter)(),[r,t]=(0,l.useState)(!1),[c,d]=(0,l.useState)(null),[u,m]=(0,l.useState)(""),[x,p]=(0,l.useState)(""),[h,b]=(0,l.useState)(""),[f,g]=(0,l.useState)(!1),[v,j]=(0,l.useState)(null),[y,N]=(0,l.useState)(!1),w=async r=>{if(r.preventDefault(),!u||!x||!h){j("Por favor completa todos los campos");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u)){j("Por favor ingresa un correo electr\xf3nico v\xe1lido");return}if(!/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,}$/.test(x)){j("La contrase\xf1a debe tener al menos 8 caracteres, incluyendo una letra y un n\xfamero");return}if(h.trim().length<3){j("El nombre debe tener al menos 3 caracteres");return}let a=u.split("@")[0].toLowerCase().replace(/[^a-z0-9]/g,"");t(!0),j(null);try{let r=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:u.trim(),password:x,username:a,name:h.trim()})}),t=await r.json();if(!r.ok)throw Error(t.message||"Error al registrar el usuario");let n=await (0,s.signIn)("credentials",{redirect:!1,email:u.trim(),password:x});if(null==n?void 0:n.error){e.push("/auth/signin?registered=true");return}(null==n?void 0:n.url)?e.push(n.url):e.push("/")}catch(e){console.error("Error en el registro:",e),e.message.includes("E11000")?e.message.includes("email")?j("Ya existe una cuenta con este correo electr\xf3nico"):e.message.includes("username")?j("El nombre de usuario ya est\xe1 en uso"):j("El usuario ya existe"):j(e.message||"Ocurri\xf3 un error al registrarte. Por favor, int\xe9ntalo de nuevo.")}finally{t(!1)}},k=async e=>{d(e);try{await (0,s.signIn)(e,{callbackUrl:"/"})}catch(r){console.error("Error al iniciar sesi\xf3n con "+e,r),j("Error al iniciar sesi\xf3n con ".concat(e)),d(null)}},C=[{provider:"spotify",icon:(0,a.jsx)(o.l4C,{className:"text-xl"}),text:"Reg\xedstrate con Spotify",color:"bg-[#1DB954] hover:bg-[#1ed760] text-black"},{provider:"google",icon:(0,a.jsx)(o.ldW,{className:"text-xl"}),text:"Continuar con Google",color:"bg-white hover:bg-gray-100 text-black"},{provider:"facebook",icon:(0,a.jsx)(o.Am9,{className:"text-xl text-[#1877F2]"}),text:"Continuar con Facebook",color:"bg-[#1877F2] hover:bg-[#0d6efd] text-white"},{provider:"apple",icon:(0,a.jsx)(o.oPZ,{className:"text-xl"}),text:"Continuar con Apple",color:"bg-black hover:bg-neutral-800 text-white"}],S=async e=>{e.preventDefault(),N(!0);try{await w(e)}catch(e){console.error("Error en el formulario:",e),N(!1)}};return(0,a.jsxs)("main",{className:"flex-1 flex flex-col items-center justify-center p-4",children:[(0,a.jsxs)("div",{className:"max-w-md w-full bg-black/50 backdrop-blur-md rounded-lg p-8 border border-neutral-800 transition-opacity duration-300 ".concat(y?"opacity-75":"opacity-100"),children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-center mb-8",children:y?"Procesando...":"Reg\xedstrate en Spotify"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"space-y-4",children:C.map(e=>{let{provider:t,icon:s,text:n,color:l}=e;return(0,a.jsx)("button",{onClick:()=>k(t),disabled:!!c,className:"w-full font-bold py-3 px-6 rounded-full flex items-center justify-center gap-3 transition-all duration-200 ".concat(c?"opacity-70 cursor-not-allowed":""," ").concat(l," ").concat(r?"opacity-70 cursor-not-allowed":""),children:c===t?(0,a.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-current"}):(0,a.jsxs)(a.Fragment,{children:[s,n]})},t)})}),(0,a.jsxs)("div",{className:"relative flex items-center my-6",children:[(0,a.jsx)("div",{className:"flex-1 border-t border-neutral-700"}),(0,a.jsx)("span",{className:"px-4 text-neutral-400 text-sm",children:"o"}),(0,a.jsx)("div",{className:"flex-1 border-t border-neutral-700"})]}),(0,a.jsxs)("form",{onSubmit:S,className:"space-y-4",children:[v&&(0,a.jsx)("div",{className:"bg-red-900/50 border border-red-700 text-red-200 px-4 py-3 rounded mb-4 text-sm",children:v}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"displayName",className:"block text-sm font-medium text-neutral-300 mb-1",children:"\xbfC\xf3mo quieres que te llamemos?"}),(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)("input",{type:"text",id:"displayName",value:h,onChange:e=>b(e.target.value),className:"w-full bg-neutral-900 border border-neutral-700 rounded px-4 py-3 text-white placeholder-neutral-500 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Introduce un nombre de perfil",disabled:r})}),(0,a.jsx)("p",{className:"mt-1 text-xs text-neutral-400",children:"Esto aparece en tu perfil."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-neutral-300 mb-1",children:"Correo electr\xf3nico"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(o.SRX,{className:"text-gray-400"})}),(0,a.jsx)("input",{type:"email",id:"email",value:u,onChange:e=>m(e.target.value),className:"w-full bg-neutral-900 border border-neutral-700 rounded pl-10 pr-4 py-3 text-white placeholder-neutral-500 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Introduce tu correo electr\xf3nico",disabled:r})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-neutral-300 mb-1",children:"Crea una contrase\xf1a"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(o.kUi,{className:"text-gray-400"})}),(0,a.jsx)("input",{type:f?"text":"password",id:"password",value:x,onChange:e=>p(e.target.value),className:"w-full bg-neutral-900 border border-neutral-700 rounded pl-10 pr-10 py-3 text-white placeholder-neutral-500 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Crea una contrase\xf1a",disabled:r}),(0,a.jsx)("button",{type:"button",onClick:()=>g(!f),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-white",disabled:r,children:f?(0,a.jsx)(o.tgn,{}):(0,a.jsx)(o.dSq,{})})]}),(0,a.jsx)("p",{className:"mt-1 text-xs text-neutral-400",children:"Usa 8 caracteres como m\xednimo con una letra y un n\xfamero."})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",id:"terms",className:"h-4 w-4 text-green-500 rounded border-neutral-600 bg-neutral-800 focus:ring-green-500",required:!0}),(0,a.jsxs)("label",{htmlFor:"terms",className:"ml-2 block text-sm text-neutral-300",children:["Acepto los ",(0,a.jsx)("a",{href:"#",className:"text-green-500 hover:underline",children:"T\xe9rminos y condiciones"})," de Spotify"]})]}),(0,a.jsx)("button",{type:"submit",disabled:r,className:"w-full bg-green-500 hover:bg-green-600 text-black font-bold py-3 px-4 rounded-full transition-colors duration-200 flex items-center justify-center gap-2",children:r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-black"}),"Creando cuenta..."]}):"Registrarte"})]}),(0,a.jsx)("div",{className:"text-center mt-6",children:(0,a.jsxs)("p",{className:"text-neutral-400",children:["\xbfYa tienes una cuenta?"," ",(0,a.jsx)(i.default,{href:"/auth/signin",className:"text-white hover:text-green-500 hover:underline",children:"Inicia sesi\xf3n en Spotify"})]})})]})]}),(0,a.jsx)("div",{className:"mt-8 text-center text-xs text-neutral-400 max-w-md",children:(0,a.jsxs)("p",{children:["Este sitio est\xe1 protegido por reCAPTCHA y se aplican la"," ",(0,a.jsx)("a",{href:"#",className:"underline hover:text-white",children:"Pol\xedtica de privacidad"})," y los"," ",(0,a.jsx)("a",{href:"#",className:"underline hover:text-white",children:"T\xe9rminos de servicio"})," de Google."]})})]})}function d(){let e=(0,n.useRouter)(),r=(0,n.useSearchParams)()||new URLSearchParams,t=(null==r?void 0:r.get("callbackUrl"))||"/",{data:o}=(0,s.useSession)();return(0,l.useEffect)(()=>{o&&e.push(t)},[o,e,t]),(0,a.jsx)(c,{})}}},function(e){e.O(0,[699,25,138,971,23,744],function(){return e(e.s=8516)}),_N_E=e.O()}]);